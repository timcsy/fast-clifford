# 資料模型：Bott 週期性優化

**功能**: 007-bott-optimization
**日期**: 2025-12-19

## 實體定義

### 1. SymmetricClWrapper

提供 Cl(p,q) 介面，內部使用 Cl(q,p) 實作。

**屬性**:

| 屬性 | 類型 | 說明 |
|------|------|------|
| `_base` | CliffordAlgebraBase | 基底代數 Cl(q,p) |
| `_p` | int | 正簽章維度 |
| `_q` | int | 負簽章維度 |
| `_swap_indices` | Tensor[int] | blade 索引重排映射表 |
| `_swap_signs` | Tensor[float] | blade 符號調整表 |

**約束**:
- p < q（否則應直接使用硬編碼代數）
- p + q < 8（否則應使用 Bott 週期性）

**狀態轉換**: 無（不可變物件）

---

### 2. BottPeriodicityAlgebra（更新）

使用張量化運算的高維 Clifford 代數。

**新增/更新屬性**:

| 屬性 | 類型 | 說明 |
|------|------|------|
| `_mult_table` | Tensor[n,n,n] | 預計算的基底代數乘法表 |
| `_outer_table` | Tensor[n,n,n] | 預計算的基底代數外積表 |
| `_reverse_signs` | Tensor[n] | 反轉運算符號表 |

**現有屬性（保留）**:

| 屬性 | 類型 | 說明 |
|------|------|------|
| `_base` | CliffordAlgebraBase | 基底代數 Cl(p mod 8, q mod 8) |
| `_p`, `_q`, `_r` | int | 簽章維度 |
| `_matrix_size` | int | 矩陣因子大小（16^週期數） |
| `_blade_count` | int | 總 blade 數 |
| `_rotor_count` | int | 偶數 grade 分量數 |

---

### 3. 乘法表張量

預計算的 Clifford 乘法表，用於張量化運算。

**結構**:
```
mult_table[i, j, k] = 當 eᵢ * eⱼ 的結果包含 eₖ 時的係數
```

**範例** (Cl(2,0)):
```
# 基底: [1, e₁, e₂, e₁₂]
# e₁ * e₂ = e₁₂
mult_table[1, 2, 3] = 1.0  # e₁ * e₂ → e₁₂

# e₁ * e₁ = 1
mult_table[1, 1, 0] = 1.0  # e₁ * e₁ → 1

# e₁₂ * e₁₂ = -1
mult_table[3, 3, 0] = -1.0  # e₁₂ * e₁₂ → -1
```

---

## 關係圖

```
┌─────────────────────────────────────────────────────────────────┐
│                         Cl(p, q) 請求                           │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
                    ┌───────────────────────┐
                    │   p + q < 8 ?         │
                    └───────────────────────┘
                           │           │
                     是    │           │   否
                           ▼           ▼
              ┌─────────────────┐  ┌───────────────────────┐
              │   p >= q ?      │  │ BottPeriodicityAlgebra│
              └─────────────────┘  │  (張量化運算)          │
                   │       │       └───────────────────────┘
              是   │       │  否
                   ▼       ▼
    ┌────────────────┐  ┌─────────────────────┐
    │HardcodedClWrapper│ │SymmetricClWrapper   │
    │ (直接使用)       │ │ (包裝 Cl(q,p))       │
    └────────────────┘  └─────────────────────┘
```

---

## 保留的代數清單

刪除後保留的 20 個預生成代數：

| p+q | 代數 | Blade 數 |
|-----|------|----------|
| 0 | Cl(0,0) | 1 |
| 1 | Cl(1,0) | 2 |
| 2 | Cl(2,0), Cl(1,1) | 4 |
| 3 | Cl(3,0), Cl(2,1) | 8 |
| 4 | Cl(4,0), Cl(3,1), Cl(2,2) | 16 |
| 5 | Cl(5,0), Cl(4,1), Cl(3,2) | 32 |
| 6 | Cl(6,0), Cl(5,1), Cl(4,2), Cl(3,3) | 64 |
| 7 | Cl(7,0), Cl(6,1), Cl(5,2), Cl(4,3) | 128 |

**刪除的代數**:
- p+q >= 8: 19 個（cl_8_*, cl_9_* 等）
- p < q: 14 個（cl_0_1, cl_0_2, cl_1_2 等）
